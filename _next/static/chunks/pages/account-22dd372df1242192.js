(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[966],{84865:function(e,n,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/account",function(){return r(88652)}])},57427:function(e,n,r){"use strict";r.d(n,{z:function(){return l}});var s=r(26042),t=r(69396),i=r(99534),a=r(85893),o=r(83321),l=function(e){var n=e.children,r=(0,i.Z)(e,["children"]);return(0,a.jsx)(o.Z,(0,t.Z)((0,s.Z)({variant:(null==r?void 0:r.variant)?r.variant:"contained"},r),{children:n}))}},11181:function(e,n,r){"use strict";r.d(n,{b:function(){return U}});var s=r(26042),t=r(828),i=r(36305),a=r(85893),o=r(67294),l=r(45697),c=r.n(l),u=r(64666),d=r(26447),h=r(15861),p=r(93946),x=r(53219),f=r(6514),m=r(47568),v=r(69396),Z=r(99534),g=r(70655),j=r(32512),b=r(2957),w=r(45331),y=r(87357),C=r(87952),_=r(78462),k=r(97212),S=r(48885),B=r(59334),R=r(34386),A=r(83321),I=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;if(0===e)return"0 Bytes";var r=Math.floor(Math.log(e)/Math.log(1024));return"".concat(parseFloat((e/Math.pow(1024,r)).toFixed(n<0?0:n))," ").concat(["Bytes","KB","MB","GB","TB","PB","EB","ZB","YB"][r])},T={jpeg:"/assets/icons/icon-jpg.svg",jpg:"/assets/icons/icon-jpg.svg",mp4:"/assets/icons/icon-mp4.svg",pdf:"/assets/icons/icon-pdf.svg",png:"/assets/icons/icon-png.svg",svg:"/assets/icons/icon-svg.svg"},z=function(e){var n,r=e.extension;return n=r&&T[r]||"/assets/icons/icon-other.svg",(0,a.jsx)("img",{src:n,alt:""})};z.propTypes={extension:c().string};var P=r(75573),E=r(86501),D=function(e){var n,r=e.caption,t=e.files,i=void 0===t?[]:t,l=e.onRemove,c=e.onRemoveAll,u=e.onUpload,f=(0,Z.Z)(e,["caption","files","onRemove","onRemoveAll","onUpload"]),T=(0,j.uI)(f),D=T.getRootProps,U=T.getInputProps,q=T.isDragActive,F=i.length>0,W=(0,o.useCallback)((n=(0,m.Z)(function(e){var n,r;return(0,g.__generator)(this,function(s){switch(s.label){case 0:n=new FormData,e.forEach(function(e,r){n.append("file".concat(r),e)}),s.label=1;case 1:return s.trys.push([1,3,,4]),[4,fetch(P.J+"/upload",{method:"POST",body:n}).then(function(e){return e.json()})];case 2:return(r=s.sent())&&u(r),[3,4];case 3:return console.log(s.sent()),E.ZP.error("Something went wrong. Try again"),[3,4];case 4:return[2]}})}),function(e){return n.apply(this,arguments)}),[u]);return(0,a.jsxs)("div",{children:[(0,a.jsxs)(y.Z,(0,v.Z)((0,s.Z)({sx:(0,v.Z)((0,s.Z)({alignItems:"center",border:1,borderRadius:1,borderStyle:"dashed",borderColor:"divider",display:"flex",flexWrap:"wrap",justifyContent:"center",outline:"none",p:6},q&&{backgroundColor:"action.active",opacity:.5}),{"&:hover":{backgroundColor:"action.hover",cursor:"pointer",opacity:.5}})},D()),{children:[(0,a.jsx)("input",(0,s.Z)({},U())),(0,a.jsxs)(d.Z,{alignItems:"center",direction:"row",spacing:2,children:[(0,a.jsx)(C.Z,{sx:{height:64,width:64},children:(0,a.jsx)(x.Z,{children:(0,a.jsx)(b.Z,{})})}),(0,a.jsxs)(d.Z,{spacing:1,children:[(0,a.jsxs)(h.Z,{sx:{"& span":{textDecoration:"underline"}},variant:"h6",children:[(0,a.jsx)("span",{children:"Click to upload"})," or drag and drop"]}),r&&(0,a.jsx)(h.Z,{color:"text.secondary",variant:"body2",children:r})]})]})]})),F&&(0,a.jsxs)(y.Z,{sx:{mt:2},children:[(0,a.jsx)(_.Z,{children:i.map(function(e){var n=e.name.split(".").pop();return(0,a.jsxs)(k.ZP,{sx:{border:1,borderColor:"divider",borderRadius:1,"& + &":{mt:1}},children:[(0,a.jsx)(S.Z,{children:(0,a.jsx)(z,{extension:n})}),(0,a.jsx)(B.Z,{primary:e.name,primaryTypographyProps:{variant:"subtitle2"},secondary:I(e.size)}),(0,a.jsx)(R.Z,{title:"Remove",children:(0,a.jsx)(p.Z,{edge:"end",onClick:function(){return null==l?void 0:l(e)},children:(0,a.jsx)(x.Z,{children:(0,a.jsx)(w.Z,{})})})})]},e.path)})}),(0,a.jsxs)(d.Z,{alignItems:"center",direction:"row",justifyContent:"flex-end",spacing:2,sx:{mt:2},children:[(0,a.jsx)(A.Z,{color:"inherit",onClick:c,size:"small",type:"button",children:"Remove All"}),(0,a.jsx)(A.Z,{onClick:function(){W(i)},size:"small",type:"button",variant:"contained",children:"Upload"})]})]})]})};D.propTypes={caption:c().string,files:c().array,onRemove:c().func,onRemoveAll:c().func,onUpload:c().func,accept:c().objectOf(c().arrayOf(c().string.isRequired).isRequired),disabled:c().bool,getFilesFromEvent:c().func,maxFiles:c().number,maxSize:c().number,minSize:c().number,noClick:c().bool,noDrag:c().bool,noDragEventsBubbling:c().bool,noKeyboard:c().bool,onDrop:c().func,onDropAccepted:c().func,onDropRejected:c().func,onFileDialogCancel:c().func,preventDropOnDocument:c().bool};var U=function(e){var n=e.onClose,r=e.open,l=void 0!==r&&r,c=e.onUpload,m=(0,t.Z)((0,o.useState)([]),2),v=m[0],Z=m[1],g=Boolean(!(e.multiple||e.multiple)&&v.length);(0,o.useEffect)(function(){Z([])},[l]);var j=(0,o.useCallback)(function(e){g||Z(function(n){return(0,i.Z)(n).concat((0,i.Z)(e))})},[g]),b=(0,o.useCallback)(function(e){Z(function(n){return n.filter(function(n){return n.path!==e.path})})},[]),y=(0,o.useCallback)(function(){Z([])},[]);return(0,a.jsxs)(u.Z,{fullWidth:!0,maxWidth:"sm",open:l,onClose:n,children:[(0,a.jsxs)(d.Z,{alignItems:"center",direction:"row",justifyContent:"space-between",spacing:3,sx:{px:3,py:2},children:[(0,a.jsx)(h.Z,{variant:"h6",children:"Upload Files"}),(0,a.jsx)(p.Z,{color:"inherit",onClick:n,children:(0,a.jsx)(x.Z,{children:(0,a.jsx)(w.Z,{})})})]}),(0,a.jsx)(f.Z,{children:(0,a.jsx)(D,(0,s.Z)({files:v,onDrop:j,onRemove:b,onRemoveAll:y,onUpload:function(){n(),c(v)}},e))})]})};U.propTypes={onClose:c().func,open:c().bool}},61124:function(e,n,r){"use strict";r.d(n,{I:function(){return p}});var s=r(26042),t=r(69396),i=r(99534),a=r(828),o=r(85893),l=r(50135),c=r(16829),u=r(67294),d=r(66660),h=(0,c.Z)(l.Z)({"& .MuiFormHelperText-root.Mui-error":{position:"absolute",top:"100%"},"input::-webkit-outer-spin-button, input::-webkit-inner-spin-button":{WebkitAppearance:"none"},"& .MuiSelect-select":{paddingTop:21}}),p=function(e){var n=e.children,r=e.type,l=(0,i.Z)(e,["children","type"]),c=(0,a.Z)((0,u.useState)(l.value||""),2),p=c[0],x=c[1];(0,u.useEffect)(function(){x(l.value)},[l.value]);var f=function(e){var n;null===(n=l.onChange)||void 0===n||n.call(l,e)};return"color"===r?(0,o.jsx)(d.O,(0,t.Z)((0,s.Z)({},l),{type:"text"})):(0,o.jsx)(h,(0,t.Z)((0,s.Z)({},l),{type:r,value:p,onChange:function(e){x(e.target.value),l.select&&f(e)},onBlur:function(e){var n;l.select||f(e),null===(n=l.handleBlur)||void 0===n||n.call(l,e)},children:n}))}},88652:function(e,n,r){"use strict";r.r(n),r.d(n,{default:function(){return es}});var s,t=r(47568),i=r(26042),a=r(828),o=r(70655),l=r(85893),c=r(67294),u=r(87357),d=r(26447),h=r(15861),p=r(88409),x=r(40044),f=r(67720),m=r(69396),v=r(99534),Z=r(51647),g=r(92736),j=r(45697),b=r.n(j),w=r(66242),y=r(44267),C=r(81426),_=r(53219),k=r(87952),S=r(83321),B=r(18972),R=r(41796),A=r(61124),I=r(82175),T=r(74231),z=r(11181),P=[{icon:"/assets/flags/flag-uk.svg",label:"English",value:"en"},{icon:"/assets/flags/flag-ru.svg",label:"Russian",value:"ru"}],E=T.Ry({email:T.Z_().email("Must be a valid email").max(255).required("Email is required"),name:T.Z_().max(255).required("Name is required"),timezone:T.Rx(),language:T.Z_().oneOf(["en","ru"])}),D=function(e){var n=e.user,r=e.onSubmit,s=e.onUpload,p=e.editGrant,x=e.isAdmin,f=(0,v.Z)(e,["user","onSubmit","onUpload","editGrant","isAdmin"]),j=(0,a.Z)((0,c.useState)(!1),2),b=j[0],T=j[1],D=(0,a.Z)((0,c.useState)(null),2),U=D[0],q=D[1],F=(0,a.Z)((0,c.useState)(!1),2),W=F[0],O=F[1],M=!(x||p);(0,c.useEffect)(function(){var e;(e=(0,t.Z)(function(){var e,n;return(0,o.__generator)(this,function(r){switch(r.label){case 0:return[4,fetch("/timezones.json").then(function(e){return e.json()})];case 1:for(var s in e=r.sent(),n=[],e)n.push({value:+s,label:e[s]});return q(n),[2]}})}),function(){return e.apply(this,arguments)})()},[]);var G=(0,c.useCallback)(function(){T(!0)},[]),N=(0,c.useCallback)(function(){T(!1)},[]),V={name:(null==n?void 0:n.name)||"",email:(null==n?void 0:n.email)||"",avatar:(null==n?void 0:n.avatar)||"",timezone:(null==n?void 0:n.timezone)||0,language:(null==n?void 0:n.language)||"en"},H=(0,I.TA)({initialValues:V,validationSchema:E,onSubmit:function(e,n){try{r(e)}catch(s){console.error(s),n.setStatus({success:!1}),n.setErrors({submit:s.message}),n.setSubmitting(!1)}}});return(0,l.jsxs)(d.Z,(0,m.Z)((0,i.Z)({spacing:4},f),{children:[(0,l.jsx)(w.Z,{children:(0,l.jsx)(y.Z,{children:(0,l.jsxs)(C.Z,{container:!0,spacing:3,children:[(0,l.jsx)(C.Z,{xs:12,md:4,children:(0,l.jsx)(h.Z,{variant:"h6",children:"Basic details"})}),(0,l.jsx)(C.Z,{xs:12,md:8,children:(0,l.jsxs)(d.Z,{spacing:3,children:[(0,l.jsxs)(d.Z,{alignItems:"center",direction:"row",spacing:2,children:[(0,l.jsx)(u.Z,{sx:{borderColor:"neutral.300",borderRadius:"50%",borderStyle:"dashed",borderWidth:1,p:"4px"},children:(0,l.jsxs)(u.Z,{sx:{borderRadius:"50%",height:"100%",width:"100%",position:"relative"},children:[(x||p)&&(0,l.jsx)(u.Z,{sx:{alignItems:"center",backgroundColor:function(e){return(0,R.Fq)(e.palette.neutral[700],.5)},borderRadius:"50%",color:"common.white",cursor:"pointer",display:"flex",height:"100%",justifyContent:"center",left:0,opacity:0,position:"absolute",top:0,width:"100%",zIndex:1,"&:hover":{opacity:1}},onClick:G,children:(0,l.jsxs)(d.Z,{alignItems:"center",direction:"row",spacing:1,children:[(0,l.jsx)(_.Z,{color:"inherit",children:(0,l.jsx)(Z.Z,{})}),(0,l.jsx)(h.Z,{color:"inherit",variant:"subtitle2",sx:{fontWeight:700},children:"Select"})]})}),(0,l.jsx)(k.Z,{src:(null==n?void 0:n.avatar)||"/assets/avatars/avatar-anika-visser.png",sx:{height:100,width:100},children:(0,l.jsx)(_.Z,{children:(0,l.jsx)(g.Z,{})})})]})}),(x||p)&&(0,l.jsx)(S.Z,{color:"inherit",size:"small",onClick:G,children:"Change"})]}),(0,l.jsx)("form",{noValidate:!0,children:(0,l.jsxs)(d.Z,{spacing:3,children:[(0,l.jsx)(A.I,{fullWidth:!0,label:"Full name",name:"name",type:"text",error:!!(H.touched.name&&H.errors.name),helperText:H.touched.name&&H.errors.name,onBlur:H.handleBlur,onChange:H.handleChange,value:H.values.name,disabled:M}),(0,l.jsx)(A.I,{fullWidth:!0,label:"Email Address",name:"email",type:"email",error:!!(H.touched.email&&H.errors.email),helperText:H.touched.email&&H.errors.email,onBlur:H.handleBlur,onChange:H.handleChange,value:H.values.email,disabled:M}),(0,l.jsx)(A.I,{name:"avatar",type:"text",value:H.values.avatar,sx:{display:"none"}}),(0,l.jsxs)(A.I,{fullWidth:!0,label:"Timezone",name:"timezone",onBlur:H.handleBlur,onChange:H.handleChange,select:!0,value:U?H.values.timezone:"",disabled:M,children:[!U&&(0,l.jsx)(B.Z,{value:""}),U&&U.map(function(e){return(0,l.jsx)(B.Z,{value:e.value,children:e.label},e.value)})]}),(0,l.jsx)(A.I,{fullWidth:!0,label:"Language",name:"language",onBlur:H.handleBlur,onChange:H.handleChange,select:!0,value:H.values.language,disabled:M,children:P.map(function(e){return(0,l.jsx)(B.Z,{value:e.value,children:(0,l.jsxs)(d.Z,{direction:"row",spacing:2,alignItems:"center",children:[(0,l.jsx)("img",{alt:e.label,src:e.icon}),(0,l.jsx)(u.Z,{children:e.label})]})},e.value)})}),(0,l.jsx)(d.Z,{direction:"row",justifyContent:"end",children:(0,l.jsx)(S.Z,{size:"large",disabled:W,onClick:function(e){O(!0),setTimeout(function(){O(!1)},500),H.handleSubmit(e)},children:"Save"})})]})})]})})]})})}),(0,l.jsx)(z.b,{onClose:N,open:b,onUpload:function(e){s(e),N()},multiple:!1})]}))};D.propTypes={user:b().object,onSubmit:b().func,updateAvatar:b().func};var U=r(87109),q=r(93946),F=r(78445),W=r(57427),O=r(52186),M=r(58883),G=r(86501),N=r(4056),V={old_password:"",password:"",confirm_password:""},H=T.Ry({old_password:T.Z_().max(255).required("Enter old password"),password:T.Z_().min(8).max(255).required("Password is required"),confirm_password:T.Z_().oneOf([T.iH("password")],"Passwords must match").max(255).required("Password is required")}),J=function(e){var n,r=e.user,s=e.isAdmin,p=e.editGrant,x=(0,v.Z)(e,["user","isAdmin","editGrant"]),f=(0,a.Z)((0,c.useState)(!1),2),Z=f[0],g=f[1],j=(0,a.Z)((0,c.useState)(!1),2),b=j[0],_=j[1],k=(0,a.Z)((0,c.useState)("enabled"===r.twofa.status),2),S=k[0],B=k[1],R=(0,a.Z)((0,c.useState)(""),2),T=R[0],z=R[1],P=x.onUpdate,E=!(s||p),D=(0,c.useCallback)(function(){S?(P((0,m.Z)((0,i.Z)({},r),{twofa:{status:"disabled"}})),B(!1)):B(!0)},[S,r,P]);(0,c.useEffect)(function(){var e,n=(e=(0,t.Z)(function(){var e,n,r;return(0,o.__generator)(this,function(s){switch(s.label){case 0:return[4,N.h.users.qr({size:300})];case 1:return n=(e=s.sent()).result,r=e.error,n?z(n):r&&G.ZP.error(r),[2]}})}),function(){return e.apply(this,arguments)});S&&n()},[S]);var J=(0,I.TA)({initialValues:V,validationSchema:H,onSubmit:(n=(0,t.Z)(function(e,n){return(0,o.__generator)(this,function(s){try{e.password!==r.password?G.ZP.error("You entered wrong password"):P(e)}catch(t){console.error(t),n.setStatus({success:!1}),n.setErrors({submit:t.message}),n.setSubmitting(!1)}return[2]})}),function(e,r){return n.apply(this,arguments)})});return(0,l.jsxs)(d.Z,{spacing:4,children:[(0,l.jsx)(w.Z,{children:(0,l.jsx)(y.Z,{children:(0,l.jsxs)(C.Z,{container:!0,spacing:3,children:[(0,l.jsx)(C.Z,{xs:12,md:4,children:(0,l.jsx)(h.Z,{variant:"h6",children:"Change password"})}),(0,l.jsx)(C.Z,{xs:12,sm:12,md:8,children:(0,l.jsxs)(d.Z,{spacing:3,children:[(0,l.jsx)(A.I,{error:!!(J.touched.old_password&&J.errors.old_password),fullWidth:!0,helperText:J.touched.old_password&&J.errors.old_password,label:"Password",name:"old_password",onBlur:J.handleBlur,onChange:J.handleChange,type:Z?"text":"password",value:J.values.old_password,isDisabled:E,InputProps:{endAdornment:(0,l.jsx)(U.Z,{position:"end",children:(0,l.jsx)(q.Z,{"aria-label":"toggle password visibility",onClick:function(){g(!Z)},color:"primary",children:Z?(0,l.jsx)(O.Z,{}):(0,l.jsx)(M.Z,{})})})}}),(0,l.jsx)(A.I,{error:!!(J.touched.password&&J.errors.password),fullWidth:!0,helperText:J.touched.password&&J.errors.password,label:"New password",name:"password",onBlur:J.handleBlur,onChange:J.handleChange,type:"password",value:J.values.password,isDisabled:E}),(0,l.jsx)(A.I,{error:!!(J.touched.confirm_password&&J.errors.confirm_password),fullWidth:!0,helperText:J.touched.confirm_password&&J.errors.confirm_password,label:"Confirm password",name:"confirm_password",onBlur:J.handleBlur,onChange:J.handleChange,type:"password",value:J.values.confirm_password,isDisabled:E}),(0,l.jsx)(d.Z,{justifyContent:"end",direction:"row",children:(0,l.jsx)(W.z,{size:"large",disabled:b,onClick:function(e){_(!0),setTimeout(function(){_(!1)},500),J.handleSubmit(e)},children:"Save"})})]})})]})})}),(0,l.jsxs)(w.Z,{children:[(0,l.jsx)(F.Z,{title:"Two Factor Authentication"}),(0,l.jsx)(y.Z,{sx:{pt:0},children:(0,l.jsxs)(C.Z,{container:!0,spacing:4,children:[(0,l.jsx)(C.Z,{xs:12,sm:6,children:(0,l.jsx)(w.Z,{sx:{height:"100%"},variant:"outlined",children:(0,l.jsxs)(y.Z,{children:[(0,l.jsx)(u.Z,{sx:{display:"block",position:"relative"},children:(0,l.jsx)(u.Z,{sx:{"&::before":{backgroundColor:S?"success.main":"error.main",borderRadius:"50%",content:'""',display:"block",height:8,left:4,position:"absolute",top:7,width:8,zIndex:1}},children:(0,l.jsx)(h.Z,{color:S?"success.main":"error",sx:{pl:3},variant:"body2",children:S?"On":"Off"})})}),(0,l.jsx)(h.Z,{sx:{mt:1},variant:"subtitle2",children:"Google Authentication"}),(0,l.jsx)(h.Z,{color:"text.secondary",sx:{mt:1},variant:"body2",children:"Use an authenticator app to scan generated QR code."}),(0,l.jsx)(u.Z,{sx:{mt:4},children:(0,l.jsx)(W.z,{variant:"outlined",onClick:D,disabled:E,children:S?"Disable":"Set Up"})})]})})}),S&&(0,l.jsx)(C.Z,{sm:6,xs:12,children:(0,l.jsx)(w.Z,{sx:{height:"100%"},variant:"outlined",children:(0,l.jsxs)(y.Z,{children:[(0,l.jsx)(h.Z,{variant:"subtitle2",children:"Scan code or type below code in your app"}),!!T.length&&(0,l.jsx)("img",{src:T,alt:"",style:{width:"100%"}}),(0,l.jsx)(h.Z,{variant:"body2",children:r.twofa.key})]})})})]})})]})]})},K=r(92951),X=r(75573),Y=r(74024),L=r(83720),Q=r(58241),$=[{label:"General",value:"general"},{label:"Security",value:"security"}],ee=function(e,n){var r=(0,i.Z)({},e,n);for(var s in r)""===r[s]&&delete r[s];return r},en=(s=(0,t.Z)(function(e,n,r){var s;return(0,o.__generator)(this,function(t){switch(t.label){case 0:return s=ee(e,n),[4,N.h.users.update(s)];case 1:return t.sent().error?G.ZP.error("Something went wrong"):(r(Y.Nw.fillMe(s)),G.ZP.success("Changes saved")),[2]}})}),function(e,n,r){return s.apply(this,arguments)}),er=function(){var e=(0,a.Z)((0,c.useState)("general"),2),n=e[0],r=e[1],s=(0,K.P)().data,t=(0,L.I0)(),o=(0,Q.a)(null==s?void 0:s.user_id).includes("users.write"),m=s&&0===s.role_id,v=(0,c.useCallback)(function(e,n){r(n)},[]),Z=(0,c.useCallback)(function(e){en(s,e,t)},[s,t]),g=(0,c.useCallback)(function(e){en(s,e,t)},[s,t]),j=(0,c.useCallback)(function(e){en(s,{avatar:X.J+e[0].path},t)},[s,t]);return s&&(0,l.jsx)(l.Fragment,{children:(0,l.jsxs)(u.Z,{children:[(0,l.jsxs)(d.Z,{spacing:3,sx:{mb:3},children:[(0,l.jsx)(h.Z,{variant:"h4",children:"Account"}),(0,l.jsxs)("div",{children:[(0,l.jsx)(p.Z,{indicatorColor:"primary",onChange:v,scrollButtons:"auto",textColor:"primary",value:n,variant:"scrollable",children:$.map(function(e){return(0,l.jsx)(x.Z,{label:e.label,value:e.value},e.value)})}),(0,l.jsx)(f.Z,{})]})]}),"general"===n&&(0,l.jsx)(D,(0,i.Z)({},{user:s,onSubmit:Z,onUpload:j,editGrant:o,isAdmin:m})),"security"===n&&(0,l.jsx)(J,{user:s,onUpdate:g,isAdmin:m,editGrant:o})]})})};er.defaultProps={title:"Account"};var es=er}},function(e){e.O(0,[235,105,133,112,774,567,179],function(){return e(e.s=84865)}),_N_E=e.O()}]);