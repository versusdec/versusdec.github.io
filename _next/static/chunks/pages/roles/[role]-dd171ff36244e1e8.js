(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[351],{90912:function(e,n,r){"use strict";var t=r(82066),i=r(85893);n.Z=(0,t.Z)((0,i.jsx)("path",{d:"M19 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.11 0 2-.9 2-2V5c0-1.1-.89-2-2-2zm-9 14-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"}),"CheckBox")},68426:function(e,n,r){"use strict";var t=r(82066),i=r(85893);n.Z=(0,t.Z)((0,i.jsx)("path",{d:"M19 5v14H5V5h14m0-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2z"}),"CheckBoxOutlineBlank")},66242:function(e,n,r){"use strict";r.d(n,{Z:function(){return g}});var t=r(87462),i=r(63366),s=r(67294),a=r(86010),l=r(94780),o=r(90948),c=r(71657),u=r(11791),d=r(1588),h=r(34867);function f(e){return(0,h.Z)("MuiCard",e)}(0,d.Z)("MuiCard",["root"]);var p=r(85893);let Z=["className","raised"],v=e=>{let{classes:n}=e;return(0,l.Z)({root:["root"]},f,n)},x=(0,o.ZP)(u.Z,{name:"MuiCard",slot:"Root",overridesResolver:(e,n)=>n.root})(()=>({overflow:"hidden"})),m=s.forwardRef(function(e,n){let r=(0,c.Z)({props:e,name:"MuiCard"}),{className:s,raised:l=!1}=r,o=(0,i.Z)(r,Z),u=(0,t.Z)({},r,{raised:l}),d=v(u);return(0,p.jsx)(x,(0,t.Z)({className:(0,a.Z)(d.root,s),elevation:l?8:void 0,ref:n,ownerState:u},o))});var g=m},83460:function(e,n,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/roles/[role]",function(){return r(51295)}])},61124:function(e,n,r){"use strict";r.d(n,{I:function(){return f}});var t=r(26042),i=r(69396),s=r(99534),a=r(828),l=r(85893),o=r(50135),c=r(16829),u=r(67294),d=r(66660),h=(0,c.Z)(o.Z)({"& .MuiFormHelperText-root.Mui-error":{position:"absolute",top:"100%"},"input::-webkit-outer-spin-button, input::-webkit-inner-spin-button":{WebkitAppearance:"none"},"& .MuiSelect-select":{paddingTop:21}}),f=function(e){var n=e.children,r=e.type,o=(0,s.Z)(e,["children","type"]),c=(0,a.Z)((0,u.useState)(o.value||""),2),f=c[0],p=c[1];(0,u.useEffect)(function(){p(o.value)},[o.value]);var Z=function(e){var n;null===(n=o.onChange)||void 0===n||n.call(o,e)};return"color"===r?(0,l.jsx)(d.O,(0,i.Z)((0,t.Z)({},o),{type:"text"})):(0,l.jsx)(h,(0,i.Z)((0,t.Z)({},o),{type:r,value:f,onChange:function(e){p(e.target.value),o.select&&Z(e)},onBlur:function(e){var n;o.select||Z(e),null===(n=o.handleBlur)||void 0===n||n.call(o,e)},children:n}))}},51295:function(e,n,r){"use strict";r.r(n),r.d(n,{default:function(){return L}});var t,i=r(47568),s=r(26042),a=r(69396),l=r(828),o=r(70655),c=r(85893),u=r(67294),d=r(41664),h=r.n(d),f=r(30136),p=r(26447),Z=r(23795),v=r(53219),x=r(15861),m=r(87918),g=r(66242),j=r(44267),b=r(18972),C=r(90052),w=r(85071),_=r(50135),S=r(83321),y=r(93041),k=r(11163),I=r(83720),N=r(79237),R=function(e){var n=(0,I.I0)(),r=(0,I.v9)(function(e){return e.roles.get}),t=r.data,i=r.loading,s=r.error,a=(0,u.useCallback)(function(){e&&n((0,N.sV)(e))},[e,n]);return(0,u.useEffect)(function(){a()},[n,e,a]),{data:t,loading:i,error:s}},E=r(39332),T=r(45697),B=r.n(T),M=r(92951),O=function(e){var n=e.children,r=(0,l.Z)((0,u.useState)(!1),2),t=r[0],i=r[1],s=(0,M.P)(),a=(0,E.useRouter)(),o=(0,u.useCallback)(function(){s&&s.user&&!["admin","client"].includes(s.user.role)?a.replace(y.H.users.index):i(!0)},[s,a]);return((0,u.useEffect)(function(){o()},[s,o]),t)?(0,c.jsx)(c.Fragment,{children:n}):null};O.propTypes={children:B().node};var z=r(74231),V=r(82175),P=r(61124),F=r(68426),H=r(90912),W=r(4056),q=r(86501),A=(t=function(){var e,n=(0,I.I0)(),r=(0,k.useRouter)(),t=(0,l.Z)((0,u.useState)(!1),2),d=t[0],E=t[1],T=(0,l.Z)((0,u.useState)([]),2),B=T[0],M=T[1],O=(0,l.Z)((0,u.useState)({name:"",description:"",status:"active",grants:[]}),2),A=O[0],L=O[1],X=+r.query.role,D=isNaN(X),G=R(X),J=G.data;G.loading,G.error,(0,u.useEffect)(function(){var e;(e=(0,i.Z)(function(){return(0,o.__generator)(this,function(e){switch(e.label){case 0:return[4,fetch("/grants.json").then(function(e){return e.json()})];case 1:return M(e.sent()),[2]}})}),function(){return e.apply(this,arguments)})()},[]),(0,u.useEffect)(function(){return J&&L(J),function(){n(N.Nw.fillRole(null))}},[n,J,X]);var K=(0,u.useMemo)(function(){return A},[A]),Q=z.Ry({name:z.Z_().max(255).required("Name is required"),description:z.Z_(),status:z.Z_().oneOf(["active","archived"]),grants:z.IX().min(1,"Select grants")}),U=(0,V.TA)({enableReinitialize:!0,initialValues:K,validationSchema:Q,errors:{},onSubmit:(e=(0,i.Z)(function(e,t){var i,a,l,c;return(0,o.__generator)(this,function(t){switch(t.label){case 0:return console.log(e),i=(0,s.Z)({},A,e),[4,W.h.roles[D?"add":"update"](i)];case 1:return l=(a=t.sent()).result,c=a.error,l&&D?r.replace("/roles/"+l):l&&!D?(n(N.Nw.fillRole(i)),q.ZP.success("Changes saved")):c&&(console.log(c),q.ZP.error("Something went wrong")),[2]}})}),function(n,r){return e.apply(this,arguments)})});return(0,c.jsx)(c.Fragment,{children:(0,c.jsxs)(c.Fragment,{children:[(0,c.jsxs)(p.Z,{spacing:4,mb:3,children:[(0,c.jsx)("div",{children:(0,c.jsxs)(Z.Z,{color:"text.primary",component:h(),href:y.H.roles.index,sx:{alignItems:"center",display:"inline-flex"},underline:"hover",children:[(0,c.jsx)(v.Z,{sx:{mr:1},children:(0,c.jsx)(f.Z,{})}),(0,c.jsx)(x.Z,{variant:"subtitle2",children:"Roles"})]})}),(0,c.jsx)(p.Z,{alignItems:"flex-start",direction:{xs:"column",md:"row"},justifyContent:"space-between",spacing:4,children:(0,c.jsx)(p.Z,{alignItems:"center",direction:"row",spacing:2,children:(0,c.jsxs)(p.Z,{children:[(0,c.jsxs)(x.Z,{variant:"h4",children:[D&&"Add role",!D&&A.name]}),!D&&(0,c.jsx)(c.Fragment,{children:(0,c.jsxs)(p.Z,{alignItems:"center",direction:"row",spacing:1,children:[(0,c.jsx)(x.Z,{variant:"subtitle2",children:"ID:"}),(0,c.jsx)(m.Z,{label:A.id,size:"small"})]})})]})})})]}),(0,c.jsx)(p.Z,{spacing:4,children:(0,c.jsx)(g.Z,{children:(0,c.jsx)(j.Z,{children:(0,c.jsx)(p.Z,{spacing:3,children:(0,c.jsx)("form",{noValidate:!0,children:(0,c.jsxs)(p.Z,{spacing:3,children:[(0,c.jsx)(P.I,{fullWidth:!0,label:"Name",name:"name",type:"text",error:!!(U.touched.name&&U.errors.name),helperText:U.touched.name&&U.errors.name,onBlur:U.handleBlur,onChange:U.handleChange,value:U.values.name}),(0,c.jsx)(P.I,{fullWidth:!0,label:"Description",name:"description",type:"text",error:!!(U.touched.description&&U.errors.description),helperText:U.touched.description&&U.errors.description,onBlur:U.handleBlur,onChange:U.handleChange,value:U.values.description}),(0,c.jsxs)(P.I,{fullWidth:!0,label:"Status",name:"status",onChange:U.handleChange,select:!0,value:U.values.status||"",children:[(0,c.jsx)(b.Z,{value:"active",children:"Active"},"active"),(0,c.jsx)(b.Z,{value:"archived",children:"Blocked"},"archived")]}),(0,c.jsx)(C.Z,{multiple:!0,options:B,disableCloseOnSelect:!0,getOptionLabel:function(e){return e},isOptionEqualToValue:function(e,n){return e===n},value:U.values.grants||[],renderOption:function(e,n,r){var t=r.selected;return(0,c.jsxs)("li",(0,a.Z)((0,s.Z)({},e),{children:[(0,c.jsx)(w.Z,{icon:(0,c.jsx)(F.Z,{fontSize:"small"}),checkedIcon:(0,c.jsx)(H.Z,{fontSize:"small"}),style:{marginRight:8},checked:t}),n]}))},onChange:function(e,n){U.setFieldValue("grants",n)},renderInput:function(e){return(0,c.jsx)(_.Z,(0,a.Z)((0,s.Z)({},e),{fullWidth:!0,error:!!U.errors.grants,helperText:U.errors.grants,label:"Grants",placeholder:"Select grants"}))}}),(0,c.jsx)(p.Z,{direction:"row",justifyContent:"end",children:(0,c.jsx)(S.Z,{size:"large",type:"submit",variant:"contained",disabled:d,onClick:function(e){E(!0),setTimeout(function(){E(!1)},500),U.handleSubmit(e)},children:"Save"})})]})})})})})})]})})},function(e){return(0,c.jsx)(O,{children:(0,c.jsx)(t,(0,s.Z)({},e))})}),L=A;A.defaultProps={title:"Roles"}}},function(e){e.O(0,[235,918,52,984,774,567,179],function(){return e(e.s=83460)}),_N_E=e.O()}]);