(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[892],{4625:function(e,n,t){"use strict";var r=t(82066),i=t(85893);n.Z=(0,r.Z)((0,i.jsx)("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zM4 12c0-4.42 3.58-8 8-8 1.85 0 3.55.63 4.9 1.69L5.69 16.9C4.63 15.55 4 13.85 4 12zm8 8c-1.85 0-3.55-.63-4.9-1.69L18.31 7.1C19.37 8.45 20 10.15 20 12c0 4.42-3.58 8-8 8z"}),"Block")},52584:function(e,n,t){"use strict";var r=t(82066),i=t(85893);n.Z=(0,r.Z)((0,i.jsx)("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zm4.59-12.42L10 14.17l-2.59-2.58L6 13l4 4 8-8z"}),"CheckCircleOutlined")},95537:function(e,n,t){"use strict";var r=t(82066),i=t(85893);n.Z=(0,r.Z)((0,i.jsx)("path",{d:"M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"}),"Close")},60666:function(e,n,t){"use strict";var r=t(82066),i=t(85893);n.Z=(0,r.Z)((0,i.jsx)("path",{d:"m14.06 9.02.92.92L5.92 19H5v-.92l9.06-9.06M17.66 3c-.25 0-.51.1-.7.29l-1.83 1.83 3.75 3.75 1.83-1.83c.39-.39.39-1.02 0-1.41l-2.34-2.34c-.2-.2-.45-.29-.71-.29zm-3.6 3.19L3 17.25V21h3.75L17.81 9.94l-3.75-3.75z"}),"EditOutlined")},31425:function(e,n,t){"use strict";t.d(n,{Z:function(){return v}});var r=t(63366),i=t(87462),s=t(67294),a=t(86010),l=t(94780),o=t(90948),c=t(71657),u=t(1588),d=t(34867);function h(e){return(0,d.Z)("MuiDialogActions",e)}(0,u.Z)("MuiDialogActions",["root","spacing"]);var f=t(85893);let Z=["className","disableSpacing"],x=e=>{let{classes:n,disableSpacing:t}=e;return(0,l.Z)({root:["root",!t&&"spacing"]},h,n)},g=(0,o.ZP)("div",{name:"MuiDialogActions",slot:"Root",overridesResolver:(e,n)=>{let{ownerState:t}=e;return[n.root,!t.disableSpacing&&n.spacing]}})(({ownerState:e})=>(0,i.Z)({display:"flex",alignItems:"center",padding:8,justifyContent:"flex-end",flex:"0 0 auto"},!e.disableSpacing&&{"& > :not(:first-of-type)":{marginLeft:8}})),p=s.forwardRef(function(e,n){let t=(0,c.Z)({props:e,name:"MuiDialogActions"}),{className:s,disableSpacing:l=!1}=t,o=(0,r.Z)(t,Z),u=(0,i.Z)({},t,{disableSpacing:l}),d=x(u);return(0,f.jsx)(g,(0,i.Z)({className:(0,a.Z)(d.root,s),ownerState:u,ref:n},o))});var v=p},37645:function(e,n,t){"use strict";var r=t(87462),i=t(63366),s=t(67294),a=t(86010),l=t(94780),o=t(15861),c=t(90948),u=t(71657),d=t(4472),h=t(34182),f=t(85893);let Z=["className","id"],x=e=>{let{classes:n}=e;return(0,l.Z)({root:["root"]},d.a,n)},g=(0,c.ZP)(o.Z,{name:"MuiDialogTitle",slot:"Root",overridesResolver:(e,n)=>n.root})({padding:"16px 24px",flex:"0 0 auto"}),p=s.forwardRef(function(e,n){let t=(0,u.Z)({props:e,name:"MuiDialogTitle"}),{className:l,id:o}=t,c=(0,i.Z)(t,Z),d=x(t),{titleId:p=o}=s.useContext(h.Z);return(0,f.jsx)(g,(0,r.Z)({component:"h2",className:(0,a.Z)(d.root,l),ownerState:t,ref:n,variant:"h6",id:p},c))});n.Z=p},64964:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/users",function(){return t(81859)}])},62077:function(e,n,t){"use strict";t.d(n,{a:function(){return o}});var r=t(26042),i=t(99534),s=t(85893),a=t(87357),l=t(98456),o=function(e){var n=e.backdrop,t=e.sx;(0,i.Z)(e,["backdrop","sx"]);var o=(0,s.jsx)(a.Z,{sx:(0,r.Z)({position:"absolute",bottom:0,top:0,left:0,right:0,bgcolor:n?"rgb(0 0 1 / 30%)":"transparent",zIndex:100,display:"flex",justifyContent:"center",alignItems:"center"},t),children:(0,s.jsx)(l.Z,{disableShrink:!0,color:"primary"})});return(0,s.jsx)(s.Fragment,{children:o})}},3174:function(e,n,t){"use strict";t.d(n,{t:function(){return a}});var r=t(99534),i=t(85893),s=t(8896),a=function(e){var n=e.limit,t=e.total,a=e.page,l=e.onPageChange,o=e.onLimitChange;return(0,r.Z)(e,["limit","total","page","onPageChange","onLimitChange"]),(0,i.jsx)(s.Z,{component:"div",count:t,onPageChange:l,onRowsPerPageChange:o,page:a-1,rowsPerPage:n,rowsPerPageOptions:[10,25,50]})}},83594:function(e,n,t){"use strict";t.d(n,{h:function(){return l}});var r=t(26042),i=t(69396),s=t(828);t(11163),t(44795);var a=t(67294),l=function(){var e=(0,s.Z)((0,a.useState)({page:1,limit:10,offset:0}),2),n=e[0],t=e[1],l=(0,a.useCallback)(function(e,n){t(function(e){return(0,i.Z)((0,r.Z)({},e),{page:n+1,offset:n*e.limit})})},[]),o=(0,a.useCallback)(function(e){t(function(n){return(0,i.Z)((0,r.Z)({},n),{page:1,limit:parseInt(e.target.value,10),offset:0})})},[]);return(0,i.Z)((0,r.Z)({},n),{handlePageChange:l,handleLimitChange:o})}},81859:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return eu}});var r,i=t(47568),s=t(26042),a=t(69396),l=t(828),o=t(70655),c=t(85893),u=t(67294),d=t(10216),h=t(26447),f=t(15861),Z=t(83321),x=t(53219),g=t(66242),p=t(99534),v=t(41664),j=t.n(v),m=t(45697),C=t.n(m),b=t(52584),k=t(4625),w=t(60666),P=t(95537),_=t(87357),S=t(7906),y=t(295),L=t(68509),R=t(98102),A=t(53184),M=t(87952),N=t(23795),z=t(34386),I=t(93946),E=t(64666),F=t(37645),T=t(6514),D=t(31425),q=t(55136),U=t(93041),W=t(3174),B=t(62077),H=function(e){var n,t,r,i,o,d=e.users,g=e.total,v=e.onPageChange,m=e.handleLimitChange,C=e.page,H=e.limit,O=e.loading,G=e.handleStatus,V=e.grants,X=e.isAdmin,J=(0,p.Z)(e,["users","total","onPageChange","handleLimitChange","page","limit","loading","handleStatus","grants","isAdmin"]),K=(0,l.Z)((0,u.useState)({open:!1,user:null}),2),Q=K[0],Y=K[1],$=X||V.includes("users.write"),ee=(0,u.useCallback)(function(e){Y({open:!0,user:e})},[]),en=(0,u.useCallback)(function(){Y({open:!1,user:null})},[]);return(0,c.jsxs)(_.Z,(0,a.Z)((0,s.Z)({sx:{position:"relative"}},J),{children:[(0,c.jsx)(q.L,{children:(0,c.jsxs)(S.Z,{sx:{minWidth:700},children:[O&&!d.length&&(0,c.jsx)(y.Z,{children:(0,c.jsx)(L.Z,{children:(0,c.jsx)(R.Z,{children:(0,c.jsx)(_.Z,{sx:{position:"relative",width:"100%",height:"200px"},children:(0,c.jsx)(B.a,{})})})})}),!O&&!d.length&&(0,c.jsx)(y.Z,{children:(0,c.jsx)(L.Z,{children:(0,c.jsx)(R.Z,{align:"center",children:(0,c.jsx)(f.Z,{variant:"subtitle2",children:"Nothing found"})})})}),!!d.length&&(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(A.Z,{children:(0,c.jsxs)(L.Z,{children:[(0,c.jsx)(R.Z,{children:"ID"}),(0,c.jsx)(R.Z,{children:"Name"}),(0,c.jsx)(R.Z,{children:"Role"}),(0,c.jsx)(R.Z,{children:"Status"}),$&&(0,c.jsx)(R.Z,{align:"right",children:"Actions"})]})}),(0,c.jsx)(y.Z,{children:d.map(function(e){return(0,c.jsxs)(L.Z,{hover:!0,children:[(0,c.jsx)(R.Z,{children:e.id}),(0,c.jsx)(R.Z,{children:(0,c.jsxs)(h.Z,{alignItems:"center",direction:"row",spacing:1,children:[(0,c.jsx)(M.Z,{src:e.avatar,sx:{height:42,width:42}}),(0,c.jsxs)("div",{children:[$?(0,c.jsx)(N.Z,{color:"inherit",component:j(),href:"".concat(U.H.users.index,"/").concat(e.id),variant:"subtitle2",children:e.name}):e.name,(0,c.jsx)(f.Z,{color:"text.secondary",variant:"body2",children:e.email})]})]})}),(0,c.jsx)(R.Z,{sx:{textTransform:"capitalize"},children:e.role}),(0,c.jsx)(R.Z,{children:(0,c.jsx)(f.Z,{sx:{textTransform:"capitalize",color:"active"===e.status?"success.main":"error.main"},children:e.status})}),$&&(0,c.jsxs)(R.Z,{align:"right",children:[(0,c.jsx)(z.Z,{title:"active"===e.status?"Block":"Unblock",children:(0,c.jsx)(I.Z,{onClick:function(){ee(e)},children:(0,c.jsx)(x.Z,{color:"blocked"===e.status?"success":"error",children:"blocked"===e.status?(0,c.jsx)(b.Z,{}):(0,c.jsx)(k.Z,{})})})}),(0,c.jsx)(z.Z,{title:"Edit",children:(0,c.jsx)(I.Z,{component:j(),href:"".concat(U.H.users.index,"/").concat(e.id),children:(0,c.jsx)(x.Z,{color:"primary",children:(0,c.jsx)(w.Z,{})})})})]})]},e.id)})})]})]})}),(0,c.jsx)(W.t,{limit:H,total:g,page:C,onPageChange:v,onLimitChange:m}),(0,c.jsxs)(E.Z,{open:Q.open,onClose:en,scroll:"paper",maxWidth:"sm",fullWidth:!0,children:[(0,c.jsxs)(F.Z,{sx:{pr:10},children:[(0,c.jsx)(I.Z,{"aria-label":"close",onClick:en,sx:{position:"absolute",right:8,top:8,color:function(e){return e.palette.primary.main}},children:(0,c.jsx)(P.Z,{})}),Q.user&&((null===(n=Q.user)||void 0===n?void 0:n.status)==="active"?"Block user #".concat(null===(t=Q.user)||void 0===t?void 0:t.id,"?"):"Unblock user #".concat(null===(r=Q.user)||void 0===r?void 0:r.id,"?"))]}),(0,c.jsxs)(T.Z,{dividers:!0,children:[Q.user&&"User "," ",Q.user&&(null===(i=Q.user)||void 0===i?void 0:i.name)+" | "+(null===(o=Q.user)||void 0===o?void 0:o.email)]}),(0,c.jsxs)(D.Z,{children:[(0,c.jsx)(Z.Z,{type:"button",variant:"outlined",color:"error",onClick:en,children:"Cancel"}),(0,c.jsx)(Z.Z,{type:"button",variant:"contained",onClick:function(){var e,n;G(null===(e=Q.user)||void 0===e?void 0:e.id,null===(n=Q.user)||void 0===n?void 0:n.status,function(){en()})},children:"Confirm"})]})]})]}))};H.propTypes={users:C().array.isRequired,total:C().number.isRequired,onPageChange:C().func.isRequired,handleLimitChange:C().func,page:C().number.isRequired,limit:C().number.isRequired};var O=t(95226),G=t(88409),V=t(40044),X=t(67720),J=t(57709),K=t(87109),Q=[{label:"All",value:"all"},{label:"Active",value:"active"},{label:"Blocked",value:"blocked"}],Y=function(e){var n=e.onFiltersChange,t=(0,u.useRef)(null),r=(0,l.Z)((0,u.useState)("all"),2),i=r[0],o=r[1],d=(0,l.Z)((0,u.useState)(e.initialFilters),2),f=d[0],Z=d[1],g=(0,u.useCallback)(function(){null==n||n(f)},[f,n]);(0,u.useEffect)(function(){g()},[f,g]);var p=(0,u.useCallback)(function(e,n){o(n),Z(function(e){var t=(0,a.Z)((0,s.Z)({},e),{status:n});return"all"===n&&delete t.status,t})},[]),v=(0,u.useCallback)(function(e){e.preventDefault(),Z(function(e){var n;return(0,a.Z)((0,s.Z)({},e),{q:null===(n=t.current)||void 0===n?void 0:n.value})})},[]);return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(G.Z,{indicatorColor:"primary",onChange:p,scrollButtons:"auto",sx:{px:3},textColor:"primary",value:i,variant:"scrollable",children:Q.map(function(e){return(0,c.jsx)(V.Z,{label:e.label,value:e.value},e.value)})}),(0,c.jsx)(X.Z,{}),(0,c.jsx)(h.Z,{alignItems:"center",direction:"row",flexWrap:"wrap",spacing:3,sx:{p:3},children:(0,c.jsx)(_.Z,{component:"form",onSubmit:v,sx:{flexGrow:1},children:(0,c.jsx)(J.Z,{defaultValue:"",fullWidth:!0,inputProps:{ref:t},placeholder:"Search users",startAdornment:(0,c.jsx)(K.Z,{position:"start",children:(0,c.jsx)(x.Z,{children:(0,c.jsx)(O.Z,{})})})})})})]})};Y.propTypes={onFiltersChange:C().func};var $=t(92951),ee=t(83720),en=t(74024),et=function(e){var n=(0,ee.I0)(),t=(0,ee.v9)(function(e){return e.users.list}),r=t.data,i=t.loading,s=t.error,a=(0,u.useCallback)(function(){e.q?n((0,en.N8)(e)):n((0,en.AG)(e))},[e,n]);return(0,u.useEffect)(function(){a()},[e,a]),{users:r,loading:i,error:s}},er=t(83594),ei=t(39332),es=t(58241),ea=function(e){var n=e.children,t=(0,ei.useRouter)(),r=(0,l.Z)((0,u.useState)(!1),2),i=r[0],s=r[1],a=(0,$.P)().data,o=(0,es.a)(null==a?void 0:a.role_id),d=(0,u.useCallback)(function(){a&&(o.length||0===a.role_id)&&(0===a.role_id||o.includes("users.read")?s(!0):t.replace(U.H.denied))},[a,o,t]);return((0,u.useEffect)(function(){d()},[a,o,d]),i)?(0,c.jsx)(c.Fragment,{children:n}):null};ea.propTypes={children:C().node};var el=t(4056),eo=t(86501),ec=(r=function(){var e,n,t=(0,ee.I0)(),r=(0,$.P)().data,p=(0,er.h)(),v=p.page,m=p.limit,C=p.offset,b=p.handlePageChange,k=p.handleLimitChange,w=(0,l.Z)((0,u.useState)({}),2),P=w[0],_=w[1],S=(0,l.Z)((0,u.useState)({grants:[]}),2),y=S[0],L=S[1],R=(0,es.a)(null==r?void 0:r.role_id),A=r&&0===r.role_id,M=(0,u.useCallback)((e=(0,i.Z)(function(e){return(0,o.__generator)(this,function(n){switch(n.label){case 0:return[4,el.h.roles.get(e)];case 1:return L(n.sent().result),[2]}})}),function(n){return e.apply(this,arguments)}),[]);(0,u.useEffect)(function(){r.role_id&&M(r.role_id)},[r,M]);var N=(0,u.useCallback)(function(e){_(e)},[]),z=et((0,u.useMemo)(function(){return(0,s.Z)({limit:m,offset:C},P)},[m,C,P])),I=z.users,E=z.loading;z.error;var F=I||{items:[],limit:m,total:0},T=F.items,D=F.total,q=(0,u.useCallback)((n=(0,i.Z)(function(e,n,r){var i;return(0,o.__generator)(this,function(l){switch(l.label){case 0:return[4,el.h.users.update({id:+e,status:"blocked"===n?"active":"blocked"})];case 1:return l.sent()?(r(),i=T.map(function(t){return t.id===+e?(0,a.Z)((0,s.Z)({},t),{status:"blocked"===n?"active":"blocked"}):t}),t(en.Nw.fillUsers(i))):eo.ZP.error("Something went wrong"),[2]}})}),function(e,t,r){return n.apply(this,arguments)}),[T,t]);return(0,c.jsx)(c.Fragment,{children:(0,c.jsxs)(h.Z,{spacing:4,children:[(0,c.jsxs)(h.Z,{direction:"row",justifyContent:"space-between",spacing:4,children:[(0,c.jsx)(h.Z,{spacing:1,children:(0,c.jsx)(f.Z,{variant:"h4",children:"Users"})}),(0,c.jsx)(h.Z,{alignItems:"center",direction:"row",spacing:3,children:r&&(0===r.role_id||y.grants.includes("users.write"))&&(0,c.jsx)(Z.Z,{component:j(),href:U.H.users.add,startIcon:(0,c.jsx)(x.Z,{children:(0,c.jsx)(d.Z,{})}),variant:"contained",children:"Add"})})]}),(0,c.jsxs)(g.Z,{children:[(0,c.jsx)(Y,{onFiltersChange:N,initialFilters:P}),(0,c.jsx)(H,{users:T,total:D,onPageChange:b,handleLimitChange:k,limit:m,page:v,loading:E,handleStatus:q,grants:R,isAdmin:A})]})]})})},function(e){return(0,c.jsx)(ea,{children:(0,c.jsx)(r,(0,s.Z)({},e))})});ec.defaultProps={title:"Users"};var eu=ec},10216:function(e,n,t){"use strict";var r=t(87462);t(67294);var i=t(85893);n.Z=function(e){return(0,i.jsx)("svg",(0,r.Z)({xmlns:"http://www.w3.org/2000/svg",width:24,height:24,fill:"none"},e,{children:(0,i.jsx)("path",{stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 5v14m-7-7h14"})}))}}},function(e){e.O(0,[105,290,896,774,567,179],function(){return e(e.s=64964)}),_N_E=e.O()}]);