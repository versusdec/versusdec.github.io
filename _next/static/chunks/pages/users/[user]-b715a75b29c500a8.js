(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[196],{90912:function(e,n,t){"use strict";var r=t(82066),s=t(85893);n.Z=(0,r.Z)((0,s.jsx)("path",{d:"M19 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.11 0 2-.9 2-2V5c0-1.1-.89-2-2-2zm-9 14-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"}),"CheckBox")},68426:function(e,n,t){"use strict";var r=t(82066),s=t(85893);n.Z=(0,r.Z)((0,s.jsx)("path",{d:"M19 5v14H5V5h14m0-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2z"}),"CheckBoxOutlineBlank")},60666:function(e,n,t){"use strict";var r=t(82066),s=t(85893);n.Z=(0,r.Z)((0,s.jsx)("path",{d:"m14.06 9.02.92.92L5.92 19H5v-.92l9.06-9.06M17.66 3c-.25 0-.51.1-.7.29l-1.83 1.83 3.75 3.75 1.83-1.83c.39-.39.39-1.02 0-1.41l-2.34-2.34c-.2-.2-.45-.29-.71-.29zm-3.6 3.19L3 17.25V21h3.75L17.81 9.94l-3.75-3.75z"}),"EditOutlined")},90656:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/users/[user]",function(){return t(44401)}])},11181:function(e,n,t){"use strict";t.d(n,{b:function(){return W}});var r=t(26042),s=t(828),i=t(36305),a=t(85893),o=t(67294),l=t(45697),c=t.n(l),u=t(64666),d=t(26447),h=t(15861),p=t(93946),f=t(53219),g=t(6514),m=t(47568),x=t(69396),Z=t(99534),j=t(70655),v=t(32512),b=t(2957),C=t(45331),w=t(87357),y=t(87952),_=t(78462),k=t(97212),S=t(48885),P=t(59334),I=t(34386),B=t(83321),z=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;if(0===e)return"0 Bytes";var t=Math.floor(Math.log(e)/Math.log(1024));return"".concat(parseFloat((e/Math.pow(1024,t)).toFixed(n<0?0:n))," ").concat(["Bytes","KB","MB","GB","TB","PB","EB","ZB","YB"][t])},R={jpeg:"/assets/icons/icon-jpg.svg",jpg:"/assets/icons/icon-jpg.svg",mp4:"/assets/icons/icon-mp4.svg",pdf:"/assets/icons/icon-pdf.svg",png:"/assets/icons/icon-png.svg",svg:"/assets/icons/icon-svg.svg"},q=function(e){var n,t=e.extension;return n=t&&R[t]||"/assets/icons/icon-other.svg",(0,a.jsx)("img",{src:n,alt:""})};q.propTypes={extension:c().string};var E=t(75573),O=t(86501),T=function(e){var n,t=e.caption,s=e.files,i=void 0===s?[]:s,l=e.onRemove,c=e.onRemoveAll,u=e.onUpload,g=(0,Z.Z)(e,["caption","files","onRemove","onRemoveAll","onUpload"]),R=(0,v.uI)(g),T=R.getRootProps,W=R.getInputProps,F=R.isDragActive,L=i.length>0,A=(0,o.useCallback)((n=(0,m.Z)(function(e){var n,t;return(0,j.__generator)(this,function(r){switch(r.label){case 0:n=new FormData,e.forEach(function(e,t){n.append("file".concat(t),e)}),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,fetch(E.J+"/upload",{method:"POST",body:n}).then(function(e){return e.json()})];case 2:return(t=r.sent())&&u(t),[3,4];case 3:return console.log(r.sent()),O.ZP.error("Something went wrong. Try again"),[3,4];case 4:return[2]}})}),function(e){return n.apply(this,arguments)}),[u]);return(0,a.jsxs)("div",{children:[(0,a.jsxs)(w.Z,(0,x.Z)((0,r.Z)({sx:(0,x.Z)((0,r.Z)({alignItems:"center",border:1,borderRadius:1,borderStyle:"dashed",borderColor:"divider",display:"flex",flexWrap:"wrap",justifyContent:"center",outline:"none",p:6},F&&{backgroundColor:"action.active",opacity:.5}),{"&:hover":{backgroundColor:"action.hover",cursor:"pointer",opacity:.5}})},T()),{children:[(0,a.jsx)("input",(0,r.Z)({},W())),(0,a.jsxs)(d.Z,{alignItems:"center",direction:"row",spacing:2,children:[(0,a.jsx)(y.Z,{sx:{height:64,width:64},children:(0,a.jsx)(f.Z,{children:(0,a.jsx)(b.Z,{})})}),(0,a.jsxs)(d.Z,{spacing:1,children:[(0,a.jsxs)(h.Z,{sx:{"& span":{textDecoration:"underline"}},variant:"h6",children:[(0,a.jsx)("span",{children:"Click to upload"})," or drag and drop"]}),t&&(0,a.jsx)(h.Z,{color:"text.secondary",variant:"body2",children:t})]})]})]})),L&&(0,a.jsxs)(w.Z,{sx:{mt:2},children:[(0,a.jsx)(_.Z,{children:i.map(function(e){var n=e.name.split(".").pop();return(0,a.jsxs)(k.ZP,{sx:{border:1,borderColor:"divider",borderRadius:1,"& + &":{mt:1}},children:[(0,a.jsx)(S.Z,{children:(0,a.jsx)(q,{extension:n})}),(0,a.jsx)(P.Z,{primary:e.name,primaryTypographyProps:{variant:"subtitle2"},secondary:z(e.size)}),(0,a.jsx)(I.Z,{title:"Remove",children:(0,a.jsx)(p.Z,{edge:"end",onClick:function(){return null==l?void 0:l(e)},children:(0,a.jsx)(f.Z,{children:(0,a.jsx)(C.Z,{})})})})]},e.path)})}),(0,a.jsxs)(d.Z,{alignItems:"center",direction:"row",justifyContent:"flex-end",spacing:2,sx:{mt:2},children:[(0,a.jsx)(B.Z,{color:"inherit",onClick:c,size:"small",type:"button",children:"Remove All"}),(0,a.jsx)(B.Z,{onClick:function(){A(i)},size:"small",type:"button",variant:"contained",children:"Upload"})]})]})]})};T.propTypes={caption:c().string,files:c().array,onRemove:c().func,onRemoveAll:c().func,onUpload:c().func,accept:c().objectOf(c().arrayOf(c().string.isRequired).isRequired),disabled:c().bool,getFilesFromEvent:c().func,maxFiles:c().number,maxSize:c().number,minSize:c().number,noClick:c().bool,noDrag:c().bool,noDragEventsBubbling:c().bool,noKeyboard:c().bool,onDrop:c().func,onDropAccepted:c().func,onDropRejected:c().func,onFileDialogCancel:c().func,preventDropOnDocument:c().bool};var W=function(e){var n=e.onClose,t=e.open,l=void 0!==t&&t,c=e.onUpload,m=(0,s.Z)((0,o.useState)([]),2),x=m[0],Z=m[1],j=Boolean(!(e.multiple||e.multiple)&&x.length);(0,o.useEffect)(function(){Z([])},[l]);var v=(0,o.useCallback)(function(e){j||Z(function(n){return(0,i.Z)(n).concat((0,i.Z)(e))})},[j]),b=(0,o.useCallback)(function(e){Z(function(n){return n.filter(function(n){return n.path!==e.path})})},[]),w=(0,o.useCallback)(function(){Z([])},[]);return(0,a.jsxs)(u.Z,{fullWidth:!0,maxWidth:"sm",open:l,onClose:n,children:[(0,a.jsxs)(d.Z,{alignItems:"center",direction:"row",justifyContent:"space-between",spacing:3,sx:{px:3,py:2},children:[(0,a.jsx)(h.Z,{variant:"h6",children:"Upload Files"}),(0,a.jsx)(p.Z,{color:"inherit",onClick:n,children:(0,a.jsx)(f.Z,{children:(0,a.jsx)(C.Z,{})})})]}),(0,a.jsx)(g.Z,{children:(0,a.jsx)(T,(0,r.Z)({files:x,onDrop:v,onRemove:b,onRemoveAll:w,onUpload:function(){n(),c(x)}},e))})]})};W.propTypes={onClose:c().func,open:c().bool}},61124:function(e,n,t){"use strict";t.d(n,{I:function(){return p}});var r=t(26042),s=t(69396),i=t(99534),a=t(828),o=t(85893),l=t(50135),c=t(16829),u=t(67294),d=t(66660),h=(0,c.Z)(l.Z)({"& .MuiFormHelperText-root.Mui-error":{position:"absolute",top:"100%"},"input::-webkit-outer-spin-button, input::-webkit-inner-spin-button":{WebkitAppearance:"none"},"& .MuiSelect-select":{paddingTop:21}}),p=function(e){var n=e.children,t=e.type,l=(0,i.Z)(e,["children","type"]),c=(0,a.Z)((0,u.useState)(l.value||""),2),p=c[0],f=c[1];(0,u.useEffect)(function(){f(l.value)},[l.value]);var g=function(e){var n;null===(n=l.onChange)||void 0===n||n.call(l,e)};return"color"===t?(0,o.jsx)(d.O,(0,s.Z)((0,r.Z)({},l),{type:"text"})):(0,o.jsx)(h,(0,s.Z)((0,r.Z)({},l),{type:t,value:p,onChange:function(e){f(e.target.value),l.select&&g(e)},onBlur:function(e){var n;l.select||g(e),null===(n=l.handleBlur)||void 0===n||n.call(l,e)},children:n}))}},62077:function(e,n,t){"use strict";t.d(n,{a:function(){return l}});var r=t(26042),s=t(99534),i=t(85893),a=t(87357),o=t(98456),l=function(e){var n=e.backdrop,t=e.sx;(0,s.Z)(e,["backdrop","sx"]);var l=(0,i.jsx)(a.Z,{sx:(0,r.Z)({position:"absolute",bottom:0,top:0,left:0,right:0,bgcolor:n?"rgb(0 0 1 / 30%)":"transparent",zIndex:100,display:"flex",justifyContent:"center",alignItems:"center"},t),children:(0,i.jsx)(o.Z,{disableShrink:!0,color:"primary"})});return(0,i.jsx)(i.Fragment,{children:l})}},3174:function(e,n,t){"use strict";t.d(n,{t:function(){return a}});var r=t(99534),s=t(85893),i=t(8896),a=function(e){var n=e.limit,t=e.total,a=e.page,o=e.onPageChange,l=e.onLimitChange;return(0,r.Z)(e,["limit","total","page","onPageChange","onLimitChange"]),(0,s.jsx)(i.Z,{component:"div",count:t,onPageChange:o,onRowsPerPageChange:l,page:a-1,rowsPerPage:n,rowsPerPageOptions:[10,25,50]})}},83594:function(e,n,t){"use strict";t.d(n,{h:function(){return o}});var r=t(26042),s=t(69396),i=t(828);t(11163),t(44795);var a=t(67294),o=function(){var e=(0,i.Z)((0,a.useState)({page:1,limit:10,offset:0}),2),n=e[0],t=e[1],o=(0,a.useCallback)(function(e,n){t(function(e){return(0,s.Z)((0,r.Z)({},e),{page:n+1,offset:n*e.limit})})},[]),l=(0,a.useCallback)(function(e){t(function(n){return(0,s.Z)((0,r.Z)({},n),{page:1,limit:parseInt(e.target.value,10),offset:0})})},[]);return(0,s.Z)((0,r.Z)({},n),{handlePageChange:o,handleLimitChange:l})}},44401:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return eb}});var r,s=t(47568),i=t(26042),a=t(69396),o=t(828),l=t(70655),c=t(85893),u=t(67294),d=t(41664),h=t.n(d),p=t(30136),f=t(26447),g=t(23795),m=t(53219),x=t(15861),Z=t(87952),j=t(87918),v=t(88409),b=t(40044),C=t(67720),w=t(93041),y=t(99534),_=t(51647),k=t(92736),S=t(66242),P=t(44267),I=t(87357),B=t(83321),z=t(18972),R=t(90052),q=t(50135),E=t(85071),O=t(87109),T=t(93946),W=t(41796),F=t(61124),L=t(11181),A=t(68426),U=t(90912),D=t(52186),M=t(58883),N=[{icon:"/assets/flags/flag-uk.svg",label:"English",value:"en"},{icon:"/assets/flags/flag-ru.svg",label:"Russian",value:"ru"}],H=function(e){var n=e.onUpload,t=e.isAdmin,r=e.timezones,s=e.user,l=e.client,d=e.clients,h=e.project,p=e.projects,g=e.roles,j=e.formik,v=(e.onChange,e.onClientChange),b=(e.onProjectChange,e.onProjectsChange),C=(0,y.Z)(e,["onUpload","isAdmin","timezones","user","client","clients","project","projects","roles","formik","onChange","onClientChange","onProjectChange","onProjectsChange"]),w=(0,o.Z)((0,u.useState)(!1),2),H=w[0],V=w[1],G=(0,o.Z)((0,u.useState)(!1),2),J=G[0],K=G[1],Q=(0,o.Z)((0,u.useState)(!1),2),X=Q[0],Y=Q[1],$=(0,u.useCallback)(function(){V(!0)},[]),ee=(0,u.useCallback)(function(){V(!1)},[]);return(0,c.jsxs)(f.Z,(0,a.Z)((0,i.Z)({spacing:4},C),{children:[(0,c.jsx)(S.Z,{children:(0,c.jsx)(P.Z,{children:(0,c.jsxs)(f.Z,{spacing:3,children:[(0,c.jsxs)(f.Z,{alignItems:"center",direction:"row",spacing:2,children:[(0,c.jsx)(I.Z,{sx:{borderColor:"neutral.300",borderRadius:"50%",borderStyle:"dashed",borderWidth:1,p:"4px"},children:(0,c.jsxs)(I.Z,{sx:{borderRadius:"50%",height:"100%",width:"100%",position:"relative"},children:[(0,c.jsx)(I.Z,{sx:{alignItems:"center",backgroundColor:function(e){return(0,W.Fq)(e.palette.neutral[700],.5)},borderRadius:"50%",color:"common.white",cursor:"pointer",display:"flex",height:"100%",justifyContent:"center",left:0,opacity:0,position:"absolute",top:0,width:"100%",zIndex:1,"&:hover":{opacity:1}},onClick:$,children:(0,c.jsxs)(f.Z,{alignItems:"center",direction:"row",spacing:1,children:[(0,c.jsx)(m.Z,{color:"inherit",children:(0,c.jsx)(_.Z,{})}),(0,c.jsx)(x.Z,{color:"inherit",variant:"subtitle2",sx:{fontWeight:700},children:"Select"})]})}),(0,c.jsx)(Z.Z,{src:null==s?void 0:s.avatar,sx:{height:100,width:100},children:(0,c.jsx)(m.Z,{children:(0,c.jsx)(k.Z,{})})})]})}),(0,c.jsx)(B.Z,{color:"inherit",size:"small",onClick:$,children:"Change"})]}),(0,c.jsx)("form",{noValidate:!0,children:(0,c.jsxs)(f.Z,{spacing:3,children:[(0,c.jsx)(F.I,{fullWidth:!0,label:"Full name",name:"name",type:"text",error:!!(j.touched.name&&j.errors.name),helperText:j.touched.name&&j.errors.name,onBlur:j.handleBlur,onChange:j.handleChange,value:j.values.name}),(0,c.jsx)(F.I,{fullWidth:!0,label:"Email Address",name:"email",type:"email",error:!!(j.touched.email&&j.errors.email),helperText:j.touched.email&&j.errors.email,onBlur:j.handleBlur,onChange:j.handleChange,value:j.values.email}),(0,c.jsx)(F.I,{name:"avatar",type:"text",value:j.values.avatar,sx:{display:"none"}}),(0,c.jsxs)(F.I,{fullWidth:!0,label:"Timezone",name:"timezone",onBlur:j.handleBlur,onChange:j.handleChange,select:!0,value:r?j.values.timezone:"",children:[!r&&(0,c.jsx)(z.Z,{value:""}),r&&r.map(function(e){return(0,c.jsx)(z.Z,{value:e.value,children:e.label},e.value)})]}),(0,c.jsx)(F.I,{fullWidth:!0,label:"Language",name:"language",onBlur:j.handleBlur,onChange:j.handleChange,select:!0,value:j.values.language||"",children:N.map(function(e){return(0,c.jsx)(z.Z,{value:e.value,children:(0,c.jsxs)(f.Z,{direction:"row",spacing:2,alignItems:"center",children:[(0,c.jsx)("img",{alt:e.label,src:e.icon}),(0,c.jsx)(I.Z,{children:e.label})]})},e.value)})}),(0,c.jsxs)(F.I,{fullWidth:!0,label:"Status",name:"status",onChange:j.handleChange,select:!0,value:j.values.status||"",children:[(0,c.jsx)(z.Z,{value:"active",children:"Active"},"active"),(0,c.jsx)(z.Z,{value:"blocked",children:"Blocked"},"blocked")]}),g.length&&(0,c.jsx)(F.I,{fullWidth:!0,label:"Role",name:"role_id",onChange:j.handleChange,select:!0,value:j.values.role_id||"",children:g.map(function(e){return(0,c.jsx)(z.Z,{value:e.id,children:(0,c.jsx)(I.Z,{sx:{textTransform:"capitalize"},children:e.name})},e.id)})}),t?!!d.length&&(0,c.jsx)(R.Z,{disablePortal:!0,disableClearable:!0,options:d,getOptionLabel:function(e){return(e.name?e.name+" | ":"")+e.email},onChange:function(e,n){v(n)},value:l||d[0]||void 0,renderInput:function(e){return(0,c.jsx)(q.Z,(0,a.Z)((0,i.Z)({},e),{fullWidth:!0,name:"client_id",label:"Client"}))}}):"",p.length&&(0,c.jsx)(R.Z,{multiple:!0,options:p,disableCloseOnSelect:!0,getOptionLabel:function(e){return e.name},isOptionEqualToValue:function(e,n){return e.id===n.id},value:h.length?h:[p[0]],renderOption:function(e,n,t){var r=t.selected;return(0,c.jsxs)("li",(0,a.Z)((0,i.Z)({},e),{children:[(0,c.jsx)(E.Z,{icon:(0,c.jsx)(A.Z,{fontSize:"small"}),checkedIcon:(0,c.jsx)(U.Z,{fontSize:"small"}),style:{marginRight:8},checked:r}),n.name]}))},onChange:function(e,n){b(n)},renderInput:function(e){return(0,c.jsx)(q.Z,(0,a.Z)((0,i.Z)({},e),{fullWidth:!0,label:"Projects",placeholder:"Select projects"}))}}),(0,c.jsx)(F.I,{error:!!(j.touched.password&&j.errors.password),fullWidth:!0,helperText:j.touched.password&&j.errors.password,label:"Password",name:"password",onBlur:j.handleBlur,onChange:j.handleChange,type:J?"text":"password",value:j.values.password||"",InputProps:{endAdornment:(0,c.jsx)(O.Z,{position:"end",children:(0,c.jsx)(T.Z,{"aria-label":"toggle password visibility",onClick:function(){K(!J)},color:"primary",children:J?(0,c.jsx)(D.Z,{}):(0,c.jsx)(M.Z,{})})})}}),(0,c.jsx)(F.I,{error:!!(j.touched.password&&j.errors.password_confirm),fullWidth:!0,helperText:j.touched.password&&j.errors.password_confirm,label:"Confirm password",name:"password_confirm",onBlur:j.handleBlur,onChange:j.handleChange,type:"password",value:j.values.password_confirm||""}),(0,c.jsx)(f.Z,{direction:"row",justifyContent:"end",children:(0,c.jsx)(B.Z,{size:"large",type:"submit",variant:"contained",disabled:X,onClick:function(e){Y(!0),setTimeout(function(){Y(!1)},500),j.handleSubmit(e)},children:"Save"})})]})})]})})}),(0,c.jsx)(L.b,{onClose:ee,open:H,onUpload:function(e){n(e),ee()}})]}))},V=t(83720),G=t(74024),J=function(e){var n=(0,V.I0)(),t=(0,V.v9)(function(e){return e.users.get}),r=t.data,s=t.loading,i=t.error,a=(0,u.useCallback)(function(){e&&n((0,G.vE)(e))},[e,n]);return(0,u.useEffect)(function(){a()},[e,a]),{data:r,loading:s,error:i}},K=t(11163),Q=t(92951),X=t(75573),Y=t(4056),$=t(86501),ee=t(39332),en=t(45697),et=t.n(en),er=t(58241),es=function(e){var n=e.children,t=(0,ee.useRouter)(),r=(0,o.Z)((0,u.useState)(!1),2),s=r[0],i=r[1],a=(0,Q.P)().data,l=(0,er.a)(null==a?void 0:a.role_id),d=(0,u.useCallback)(function(){a&&(l.length||0===a.role_id)&&(0===a.role_id||l.includes("users.write")?i(!0):t.replace(w.H.denied))},[a,l,t]);return((0,u.useEffect)(function(){d()},[a,l,d]),s)?(0,c.jsx)(c.Fragment,{children:n}):null};es.propTypes={children:et().node};var ei=t(74231),ea=t(82175),eo=t(62077),el=function(e){e.onSubmit;var n=e.items,t=e.selected,r=e.onChange,s=e.handleChange,l=(e.handleSetup,e.role,e.loading),d=(0,y.Z)(e,["onSubmit","items","selected","onChange","handleChange","handleSetup","role","loading"]),h=(0,o.Z)((0,u.useState)(!1),2);return h[0],h[1],(0,c.jsxs)(c.Fragment,{children:[l&&(0,c.jsx)(eo.a,{backdrop:!0}),(0,c.jsx)(f.Z,(0,a.Z)((0,i.Z)({spacing:4},d),{children:(0,c.jsx)(S.Z,{children:(0,c.jsx)(P.Z,{children:(0,c.jsx)(f.Z,{spacing:3,children:(0,c.jsx)(R.Z,{fullWidth:!0,multiple:!0,options:n,disableCloseOnSelect:!0,getOptionLabel:function(e){return e.name},isOptionEqualToValue:function(e,n){return e.id===n.id},value:t||[],renderOption:function(e,n,t){var r=t.selected;return(0,c.jsxs)("li",(0,a.Z)((0,i.Z)({},e),{children:[(0,c.jsx)(E.Z,{icon:(0,c.jsx)(A.Z,{fontSize:"small"}),checkedIcon:(0,c.jsx)(U.Z,{fontSize:"small"}),style:{marginRight:8},checked:r}),n.name]}))},onChange:function(e,n){r(n)},onClose:function(){s()},renderInput:function(e){return(0,c.jsx)(q.Z,(0,a.Z)((0,i.Z)({},e),{fullWidth:!0,label:"Queues",placeholder:"Select queues"}))}})})})})}))]})},ec=t(60666),eu=t(7906),ed=t(295),eh=t(68509),ep=t(98102),ef=t(53184),eg=t(34386),em=t(55136),ex=t(3174),eZ=function(e){e.items;var n=e.limit,t=e.page,r=e.total,s=e.onPageChange,o=e.handleLimitChange,l=e.users,u=e.editGrant,d=(0,y.Z)(e,["items","limit","page","total","onPageChange","handleLimitChange","users","editGrant"]);return(0,c.jsx)(S.Z,{children:(0,c.jsxs)(I.Z,(0,a.Z)((0,i.Z)({sx:{position:"relative"}},d),{children:[(0,c.jsx)(em.L,{children:(0,c.jsxs)(eu.Z,{sx:{minWidth:700},children:[!l.length&&(0,c.jsx)(ed.Z,{children:(0,c.jsx)(eh.Z,{children:(0,c.jsx)(ep.Z,{align:"center",children:(0,c.jsx)(x.Z,{variant:"subtitle2",children:"No operators attached to this user"})})})}),!!l.length&&(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(ef.Z,{children:(0,c.jsxs)(eh.Z,{children:[(0,c.jsx)(ep.Z,{children:"ID"}),(0,c.jsx)(ep.Z,{children:"Name"}),u&&(0,c.jsx)(ep.Z,{align:"right",children:"Actions"})]})}),(0,c.jsx)(ed.Z,{children:l.map(function(e){return(0,c.jsxs)(eh.Z,{hover:!0,children:[(0,c.jsx)(ep.Z,{children:e.id}),(0,c.jsx)(ep.Z,{children:(0,c.jsxs)(f.Z,{alignItems:"center",direction:"row",spacing:1,children:[(0,c.jsx)(Z.Z,{src:e.avatar,sx:{height:42,width:42}}),(0,c.jsxs)("div",{children:[u?(0,c.jsx)(g.Z,{color:"inherit",component:h(),href:"".concat(w.H.users.index,"/").concat(e.id),variant:"subtitle2",children:e.name}):e.name,(0,c.jsx)(x.Z,{color:"text.secondary",variant:"body2",children:e.email})]})]})}),u&&(0,c.jsx)(ep.Z,{align:"right",children:(0,c.jsx)(eg.Z,{title:"Edit",children:(0,c.jsx)(T.Z,{component:h(),href:"".concat(w.H.users.index,"/").concat(e.id),children:(0,c.jsx)(m.Z,{color:"primary",children:(0,c.jsx)(ec.Z,{})})})})})]},e.id)})})]})]})}),(0,c.jsx)(ex.t,{limit:n,total:r,page:t,onPageChange:s,onLimitChange:o})]}))})},ej=t(83594),ev=(r=function(){var e,n,t,r,d=(0,V.I0)(),y=(0,K.useRouter)(),_=(0,Q.P)(),k=null===(t=_.data)||void 0===t?void 0:t.role,S=(0,o.Z)((0,u.useState)("common"),2),P=S[0],I=S[1],B=(0,o.Z)((0,u.useState)(null),2),z=B[0],R=B[1],q=(0,o.Z)((0,u.useState)({name:"",email:"",timezone:180,language:"en",avatar:"",password:"",company:"",status:"active",queues:[],projects:[],users:[],role_id:1}),2),E=q[0],O=q[1],T=(0,ej.h)(),W=T.page,F=T.limit,L=T.offset,A=T.handlePageChange,U=T.handleLimitChange,D=(0,o.Z)((0,u.useState)([]),2),M=D[0],N=D[1],ee=(0,o.Z)((0,u.useState)([]),2),en=ee[0],et=ee[1],es=(0,o.Z)((0,u.useState)(null),2),eo=es[0],ec=es[1],eu=(0,o.Z)((0,u.useState)([]),2),ed=eu[0],eh=eu[1],ep=(0,o.Z)((0,u.useState)([]),2),ef=ep[0],eg=ep[1],em=(0,o.Z)((0,u.useState)([]),2),ex=em[0],ev=em[1],eb=(0,o.Z)((0,u.useState)({limit:10,total:0,items:[]}),2),eC=eb[0],ew=eb[1],ey=+y.query.user,e_=isNaN(ey),ek=J(ey).data,eS=(0,er.a)(null===(r=_.data)||void 0===r?void 0:r.role_id),eP=_.data&&0===_.data.role_id,eI=eP||eS.includes("users.write"),eB=(0,o.Z)((0,u.useState)(!1),2),ez=eB[0],eR=eB[1];(0,u.useEffect)(function(){if(ek){var e=(0,i.Z)({},ek);e.password_confirm=ek.password,O(e)}return function(){d(G.Nw.fillUser(null))}},[d,ek,ey]);var eq=(0,u.useCallback)((0,s.Z)(function(){var e;return(0,l.__generator)(this,function(n){switch(n.label){case 0:return[4,Y.h.queues.list({status:"active",limit:1e3})];case 1:return(e=n.sent().result)&&et(e.items),[2]}})}),[]),eE=(0,u.useCallback)((0,s.Z)(function(){var e;return(0,l.__generator)(this,function(n){switch(n.label){case 0:return[4,Y.h.users.list({role:"client",status:"active",limit:1e3})];case 1:return(e=n.sent().result)&&N(e.items),[2]}})}),[]),eO=(0,u.useCallback)((0,s.Z)(function(){var e;return(0,l.__generator)(this,function(n){switch(n.label){case 0:return[4,Y.h.projects.list({status:"active",limit:1e3})];case 1:return(e=n.sent().result)&&eg(e.items),[2]}})}),[]),eT=(0,u.useCallback)((0,s.Z)(function(){var e;return(0,l.__generator)(this,function(n){switch(n.label){case 0:return[4,Y.h.roles.list({status:"active",limit:1e3})];case 1:return(e=n.sent().result)&&ev(e.items),[2]}})}),[]),eW=(0,u.useCallback)((0,s.Z)(function(){var e;return(0,l.__generator)(this,function(n){switch(n.label){case 0:return[4,Y.h.users.list({status:"active",role:"manager",limit:10})];case 1:return(e=n.sent().result)&&ew(e),[2]}})}),[]);(0,u.useEffect)(function(){eO(),eT()},[eO,eT]),(0,u.useEffect)(function(){eP&&eE()},[eP,eE]),(0,u.useEffect)(function(){!e_&&(eS.includes("projects.queues.read")||eP)&&eq(),!e_&&(eS.includes("users.read")||eP)&&eW()},[e_,eS,eq,eW,eP]),(0,u.useEffect)(function(){E.client_id&&(null==M?void 0:M.length)&&ec(M.find(function(e){return e.id===E.client_id}))},[E,M]),(0,u.useEffect)(function(){if(ef.length&&!e_){var e,n=[];null===(e=E.projects)||void 0===e||e.forEach(function(e){n.push(ef.find(function(n){return n.id===e}))}),eh(n)}},[E,ef,e_]),(0,u.useEffect)(function(){var e;(e=(0,s.Z)(function(){var e,n;return(0,l.__generator)(this,function(t){switch(t.label){case 0:return[4,fetch("/timezones.json").then(function(e){return e.json()})];case 1:for(var r in e=t.sent(),n=[],e)n.push({value:+r,label:e[r]});return R(n),[2]}})}),function(){return e.apply(this,arguments)})()},[]);var eF=(0,u.useCallback)(function(e){ec(e),onChange({client_id:e.id})},[]),eL=(0,u.useCallback)(function(e){eh([e])},[]),eA=(0,u.useCallback)(function(e){eh(e)},[]),eU=(0,u.useCallback)(function(e,n){I(n)},[]),eD=(0,u.useCallback)((e=(0,s.Z)(function(e){return(0,l.__generator)(this,function(n){switch(n.label){case 0:if(O(function(n){return(0,a.Z)((0,i.Z)({},n),{avatar:X.J+e[0].path})}),e_)return[3,2];return[4,Y.h.users.update(E)];case 1:n.sent().error?$.ZP.error("Something went wrong"):(d(G.Nw.fillUser(E)),$.ZP.success("Changes saved")),n.label=2;case 2:return[2]}})}),function(n){return e.apply(this,arguments)}),[E,e_,d]),eM=(0,u.useCallback)((0,s.Z)(function(){var e,n;return(0,l.__generator)(this,function(t){switch(t.label){case 0:return eR(!0),e={id:E.id,queues:[]},E.queues.map(function(n){e.queues.push(n.id)}),[4,Y.h.users.update(e)];case 1:return n=t.sent().error,eR(!1),n&&$.ZP.error(n.message),[2]}})}),[E]),eN=(0,u.useCallback)((0,s.Z)(function(){var e,n;return(0,l.__generator)(this,function(t){switch(t.label){case 0:return[4,Y.h.queues.setup({})];case 1:return n=(e=t.sent()).result,e.error,n?$.ZP.success("Changes saved"):$.ZP.error("Something went wrong"),[2]}})}),[]),eH=(0,u.useMemo)(function(){return E},[E]),eV=ei.Ry({email:ei.Z_().email("Must be a valid email").max(255).required("Email is required"),name:ei.Z_().max(255).required("Name is required"),timezone:ei.Rx(),language:ei.Z_().oneOf(["en","de","es"]),password:ei.Z_().min(8).max(255).when("$other",{is:function(){return e_},then:ei.Z_().required("Password is required")}),password_confirm:ei.Z_().max(255).oneOf([ei.iH("password")],"Passwords must match").when("password",{is:function(e){return e&&e.length&&e_},then:ei.Z_().required("Confirm your new password").max(255)}),status:ei.Z_().oneOf(["active","blocked"]),role_id:ei.Rx()}),eG=(0,ea.TA)({enableReinitialize:!0,initialValues:eH,validationSchema:eV,errors:{},onSubmit:(n=(0,s.Z)(function(e,n){var t,r,s,o;return(0,l.__generator)(this,function(n){switch(n.label){case 0:if(""===(t=(0,i.Z)({},e)).phone&&delete t.phone,eP?t.client_id=eo.id:delete t.client_id,!e_)return[3,5];n.label=1;case 1:return n.trys.push([1,3,,4]),[4,Y.h.users.add(t)];case 2:return s=(r=n.sent()).result,o=r.error,s&&!o?y.replace("/users"+s):$.ZP.error("Something went wrong"),[3,4];case 3:return n.sent(),$.ZP.error("Something went wrong"),[3,4];case 4:return[3,7];case 5:return[4,Y.h.users.update(t)];case 6:n.sent().error?$.ZP.error("Something went wrong"):(d(G.Nw.fillUser((0,a.Z)((0,i.Z)({},t),{queues:E.queues}))),$.ZP.success("Changes saved")),n.label=7;case 7:return[2]}})}),function(e,t){return n.apply(this,arguments)})});return(0,c.jsxs)(c.Fragment,{children:[E&&(0,c.jsxs)(c.Fragment,{children:[(0,c.jsxs)(f.Z,{spacing:4,mb:3,children:[(0,c.jsx)("div",{children:(0,c.jsxs)(g.Z,{color:"text.primary",component:h(),href:w.H.users.index,sx:{alignItems:"center",display:"inline-flex"},underline:"hover",children:[(0,c.jsx)(m.Z,{sx:{mr:1},children:(0,c.jsx)(p.Z,{})}),(0,c.jsx)(x.Z,{variant:"subtitle2",children:"Users"})]})}),(0,c.jsx)(f.Z,{alignItems:"flex-start",direction:{xs:"column",md:"row"},justifyContent:"space-between",spacing:4,children:(0,c.jsxs)(f.Z,{alignItems:"center",direction:"row",spacing:2,children:[!e_&&(0,c.jsx)(Z.Z,{src:E.avatar,sx:{height:64,width:64}}),(0,c.jsxs)(f.Z,{children:[(0,c.jsxs)(x.Z,{variant:"h4",children:[e_&&"Add user",!e_&&E.name]}),!e_&&(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(x.Z,{variant:"body2",color:"text.secondary",children:E.email}),(0,c.jsxs)(f.Z,{alignItems:"center",direction:"row",spacing:1,children:[(0,c.jsx)(x.Z,{variant:"subtitle2",children:"ID:"}),(0,c.jsx)(j.Z,{label:E.id,size:"small"})]})]})]})]})}),(0,c.jsxs)("div",{children:[(0,c.jsxs)(v.Z,{indicatorColor:"primary",onChange:eU,scrollButtons:"auto",sx:{mt:3},textColor:"primary",value:P,variant:"scrollable",children:[(0,c.jsx)(b.Z,{label:"Common",value:"common"},"common"),!e_&&eS.includes("users.read")&&(0,c.jsx)(b.Z,{label:"Operators",value:"operators"},"operators"),!e_&&eS.includes("projects.queues.read")&&(0,c.jsx)(b.Z,{label:"Queues",value:"queues"},"queues")]}),(0,c.jsx)(C.Z,{})]})]}),"common"===P&&(0,c.jsx)("div",{children:(!e_&&E.id||e_)&&_.data&&(0,c.jsx)(H,{user:E,isAdmin:eP,onUpload:eD,timezones:z,clients:M,projects:ef,roles:ex,formik:eG,client:eo,onClientChange:eF,project:ed,onProjectChange:eL,onProjectsChange:eA})}),"operators"===P&&(0,c.jsx)(eZ,{users:eC.items,page:W,limit:F,offset:L,onPageChange:A,handleLimitChange:U,total:eC.total,editGrant:eI})]}),"queues"===P&&(0,c.jsx)(el,{items:en,selected:E.queues,onChange:function(e){O(function(n){return(0,a.Z)((0,i.Z)({},n),{queues:e})})},loading:ez,handleChange:eM,handleSetup:eN,role:k})]})},function(e){return(0,c.jsx)(es,{children:(0,c.jsx)(r,(0,i.Z)({},e))})}),eb=ev;ev.defaultProps={title:"Users"}}},function(e){e.O(0,[235,105,290,896,918,52,984,133,774,567,179],function(){return e(e.s=90656)}),_N_E=e.O()}]);